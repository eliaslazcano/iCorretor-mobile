{"version":3,"sources":["webpack:///./src/views/CarpPedido.vue?778c","webpack:///src/views/CarpPedido.vue","webpack:///./src/views/CarpPedido.vue?2873","webpack:///./src/views/CarpPedido.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","_v","_s","inapto","on","$event","$router","back","staticStyle","loading","preventDefault","enviarPedido","exercicio","directives","name","rawName","value","expression","$$selectedVal","Array","prototype","filter","call","target","options","o","selected","map","val","_value","iptLocalRetirada","multiple","domProps","bloquearOpcaoCorreios","_e","sending","staticRenderFns","component"],"mappings":"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","file":"js/chunk-2d0e4ac1.7b072019.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('transition',{attrs:{\"mode\":\"out-in\",\"name\":\"fade\"}},[(_vm.inapto)?_c('div',{staticClass:\"text-center\"},[_c('div',{staticClass:\"alert alert-warning d-flex justify-content-center my-3\"},[_c('p',{staticClass:\"text-justify\"},[_vm._v(_vm._s(_vm.inapto))])]),_c('button',{staticClass:\"btn btn-primary\",on:{\"click\":function($event){return _vm.$router.back()}}},[_vm._v(\"Voltar\")])]):(_vm.loading)?_c('div',{staticClass:\"position-absolute vw-100 vh-100 d-flex flex-column justify-content-center align-items-center overflow-hidden\",staticStyle:{\"background-color\":\"rgba(255, 255, 255, .6)\",\"top\":\"0\",\"z-index\":\"9\"}},[_c('div',{staticClass:\"spinner-border text-primary\",attrs:{\"role\":\"status\"}}),_vm._v(\"\\n      \"+_vm._s(_vm.loading ? _vm.loading : '')+\"\\n    \")]):_c('form',{staticClass:\"card mx-auto mt-3\",staticStyle:{\"max-width\":\"500px\"},on:{\"submit\":function($event){$event.preventDefault();return _vm.enviarPedido($event)}}},[_c('div',{staticClass:\"card-header\"},[_c('h5',{staticClass:\"card-title\"},[_vm._v(\"Cartão exercício \"+_vm._s(_vm.exercicio))])]),_c('div',{staticClass:\"card-body\"},[_c('div',{staticClass:\"form-group\"},[_c('label',{attrs:{\"for\":\"ipt-select\"}},[_vm._v(\"Local de retirada\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.iptLocalRetirada),expression:\"iptLocalRetirada\"}],staticClass:\"form-control\",attrs:{\"name\":\"ipt-select\",\"id\":\"ipt-select\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.iptLocalRetirada=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{domProps:{\"value\":0}},[_vm._v(\"Sede de Campo Grande\")]),_c('option',{domProps:{\"value\":1}},[_vm._v(\"Subsede de Dourados\")]),_c('option',{domProps:{\"value\":2}},[_vm._v(\"Subsede de Três Lagoas\")]),(!_vm.bloquearOpcaoCorreios)?_c('option',{domProps:{\"value\":3}},[_vm._v(\"Me enviar por correio\")]):_vm._e()])])]),_c('div',{staticClass:\"card-footer text-center\"},[_c('button',{staticClass:\"btn btn-primary\",attrs:{\"type\":\"submit\",\"disabled\":_vm.sending}},[_vm._v(\"Confirmar\")]),_c('router-link',{staticClass:\"btn btn-secondary\",attrs:{\"type\":\"button\",\"to\":\"/carpmenu\",\"disabled\":_vm.sending}},[_vm._v(\"Voltar\")])],1)])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <transition mode=\"out-in\" name=\"fade\">\r\n      <!-- Mensagem de inaptidão -->\r\n      <div v-if=\"inapto\" class=\"text-center\">\r\n        <div class=\"alert alert-warning d-flex justify-content-center my-3\">\r\n          <p class=\"text-justify\">{{inapto}}</p>\r\n        </div>\r\n        <button class=\"btn btn-primary\" @click=\"$router.back()\">Voltar</button>\r\n      </div>\r\n      <!-- Loader -->\r\n      <div\r\n        v-else-if=\"loading\"\r\n        class=\"position-absolute vw-100 vh-100 d-flex flex-column justify-content-center align-items-center overflow-hidden\"\r\n        style=\"background-color: rgba(255, 255, 255, .6); top: 0; z-index: 9\"\r\n      >\r\n        <div class=\"spinner-border text-primary\" role=\"status\"></div>\r\n        {{loading ? loading : ''}}\r\n      </div>\r\n      <!-- Formulario -->\r\n      <form v-else class=\"card mx-auto mt-3\" @submit.prevent=\"enviarPedido\" style=\"max-width: 500px\">\r\n        <div class=\"card-header\">\r\n          <h5 class=\"card-title\">Cartão exercício {{exercicio}}</h5>\r\n        </div>\r\n        <div class=\"card-body\">\r\n          <div class=\"form-group\">\r\n            <label for=\"ipt-select\">Local de retirada</label>\r\n            <select name=\"ipt-select\" id=\"ipt-select\" class=\"form-control\" v-model=\"iptLocalRetirada\">\r\n              <option :value=\"0\">Sede de Campo Grande</option>\r\n              <option :value=\"1\">Subsede de Dourados</option>\r\n              <option :value=\"2\">Subsede de Três Lagoas</option>\r\n              <option :value=\"3\" v-if=\"!bloquearOpcaoCorreios\">Me enviar por correio</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div class=\"card-footer text-center\">\r\n          <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"sending\">Confirmar</button>\r\n          <router-link type=\"button\" class=\"btn btn-secondary\" to=\"/carpmenu\" :disabled=\"sending\">Voltar</router-link>\r\n        </div>\r\n      </form>\r\n    </transition>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import {WebClientI2br, WebClientCreciMS} from \"../http\";\r\n  export default {\r\n    name: \"CarpPedido\",\r\n    data: () => ({\r\n      exercicio: 2021, //Configuração, altere manualmente quando virar o ano.\r\n      loading: 'Verificando aptidão...', //Boolean || String (mensagem).\r\n      inapto: false, //false || String (mensagem).\r\n      iptLocalRetirada: 0,\r\n      bloquearOpcaoCorreios: false,\r\n      sending: false,\r\n    }),\r\n    methods: {\r\n      async enviarPedido() {\r\n        if (!confirm('Confirma a solicitação do cartão ' + this.exercicio + ' para entrega no local indicado?')) {\r\n          return;\r\n        }\r\n        const webClientCreciMs = new WebClientCreciMS();\r\n        this.sending = true;\r\n        try {\r\n          await webClientCreciMs.insertCarp(this.$store.getters.cpf, this.$store.state.creci, this.$store.state.nome, this.exercicio, this.iptLocalRetirada, true, 3);\r\n          this.$toastr.success('Pedido de cartão registrado no CRECI');\r\n          this.$router.push('/carpmenu');\r\n        } catch (e) {\r\n          // eslint-disable-next-line no-console\r\n          console.log(e);\r\n          this.sending = false;\r\n        }\r\n      },\r\n      async validarAptidao() {\r\n        const webClientI2br = new WebClientI2br(this.$store.getters.cpf, 14, true);\r\n        const webClientCreciMs = new WebClientCreciMS(true);\r\n\r\n        try {\r\n          const ficha = await webClientI2br.getFicha();\r\n          const apto = ficha.certidao.apto_certidao && ficha.certidao.validade >= ((this.exercicio + 1) + '-03-31');\r\n          if (!apto) {\r\n            this.inapto = 'Você não está apto a obter o Cartão Anual de Regularidade Profissional ' + this.exercicio + '. A validade do cartão físico se estende até o fim do exercício ' + this.exercicio + ', portanto é necessário estar 100% quite com os débitos e demais pendências com o conselho.';\r\n            return;\r\n          }\r\n\r\n          const endereco = ficha.contato.endereco_correspondencia === 2 ? ficha.contato.endereco_comercial : ficha.contato.endereco_residencial;\r\n          this.bloquearOpcaoCorreios = endereco.cidade.toUpperCase().trim() === 'CAMPO GRANDE';\r\n\r\n          const carps = await webClientCreciMs.getCarpsFromCpf(this.$store.getters.cpf);\r\n          const pedido = carps.find(c => c.exercicio === this.exercicio && c.status !== 2);\r\n          if (pedido) {\r\n            this.inapto = 'Você já possui um pedido de confecção do cartão do exercício ' + this.exercicio + ', que encontra-se com o status ' + this.getStatusLiteral(pedido.status) + '. Se deseja uma segunda via deve solicitar junto ao CRECI.';\r\n            return;\r\n          }\r\n\r\n          if (!this.$store.state.recadastrado) {\r\n            this.inapto = 'Você não está regular com o RECADASTRAMENTO. Volte ao menu principal e escolha a opção \"Recadastramento\", realizando todas as etapas do procedimento.';\r\n            return;\r\n          }\r\n\r\n          this.loading = false;\r\n        } catch (e) {\r\n          this.$toastr.error('Não foi possível validar a aptidão, tente mais tarde.');\r\n        }\r\n      },\r\n      getStatusLiteral(idStatus) {\r\n        switch (idStatus) {\r\n          case 0:\r\n            return 'EM CONFECÇÃO';\r\n          case 1:\r\n            return 'PRONTO';\r\n          case 2:\r\n            return 'INDEFERIDO';\r\n          case 3:\r\n            return 'ENVIADO POR CORREIO';\r\n          case 4:\r\n            return 'RETIRADO PESSOALMENTE';\r\n        }\r\n      },\r\n    },\r\n    created() {\r\n      this.validarAptidao();\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CarpPedido.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CarpPedido.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CarpPedido.vue?vue&type=template&id=4961a21e&scoped=true&\"\nimport script from \"./CarpPedido.vue?vue&type=script&lang=js&\"\nexport * from \"./CarpPedido.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4961a21e\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}